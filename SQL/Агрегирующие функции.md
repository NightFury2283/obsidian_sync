
[[Питон Практикум]]
[[SQL]]

Например — как средствами СУБД посчитать стоимость заказа #35 в интернет-магазине? А как подбить общую стоимость заказов за 17 февраля?

##### Для решения подобных задач в SQL существуют **агрегирующие** или **агрегатные** (от англ. _aggregate_, «сгруппированный, совокупный») функции. Эти функции **выполняют вычисления** на наборе значений.

Агрегирующая функция возвращает результирующую таблицу, в которой лишь одна колонка и одна запись — результат вычислений. Например, агрегирующая функция **COUNT()** вернёт одно число — количество строк в полученной выборке.

В общем виде запрос с агрегирующей функцией выглядит так:

```sql
SELECT АГРЕГИРУЮЩАЯ_ФУНКЦИЯ(название_поля)    
FROM таблица;
```

### COUNT

Агрегирующая функция **COUNT()** (англ. «подсчёт») возвращает количество строк в результирующей выборке.

```sql
SELECT COUNT(gross)
FROM video_products;
```

В колонке **gross** есть несколько ячеек без значений (в них записано `NULL`); функция `COUNT()` не будет учитывать эти ячейки при подсчёте — ведь она пересчитывает именно значения.

В результате выполнения этого запроса вернётся результирующая таблица из одного столбца и одной строки; в единственной ячейке этой таблицы будет значение 3.

##### Для функции `COUNT` возможен особый синтаксис: `COUNT(*)`.

При записи `COUNT(*)` функция подсчитает не количество значений в какой-то колонке, а **количество записей в результирующей выборке**. Вернётся число 10.

Через `COUNT(*)` можно подсчитать число записей в любой выборке, например, с условием `WHERE`.

Ограничим выборку условием `WHERE`:

```sql
SELECT COUNT(*)
FROM video_products
WHERE product_type='Фильм';
```


### MIN и MAX

Эти агрегирующие функции предназначены для поиска максимального или минимального значения в заданном столбце.


```sql
-- ВЫБЕРИ МИНИМАЛЬНОЕ ЗНАЧЕНИЕ в колонке gross:
SELECT MIN(gross)
FROM video_products;
-- Вернёт: 25118063
 
SELECT MAX(gross)
FROM video_products;
-- Вернёт: 156452370 
```


### AVG и SUM

Часто требуется получить средние значения и итоговую сумму по какому-то столбцу. SQL может вернуть и такие данные: для этого есть агрегирующие функции AVG (от англ. _average_ «среднее») и SUM (от англ. «сумма»). Эти функции тоже игнорируют `NULL`. Подсчитываемая выборка может быть ограничена с помощью `WHERE`.


