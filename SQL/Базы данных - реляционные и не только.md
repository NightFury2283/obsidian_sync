

[[Питон Практикум]]


Управление данными — это большая часть работы в любом проекте. Информация о пользователях, описания и цены на товары, географические координаты — всё это данные, которые необходимо сохранять, обрабатывать и предоставлять пользователям.

Для хранения информации придумали **базы данных** — системы для хранения информации и доступа к ней.

База данных чем-то похожа на библиотеку: информация упорядочена, структурирована и разложена по полочкам. Этой информацией нужно как-то управлять.



Для разработчика понятия «база данных» и «СУБД» — близнецы-братья, синонимы, хотя на самом деле это две разные сущности. Когда мы говорим «в проекте используется такая-то база данных» (например, SQLite или Postgres), подразумевается не только сама база, но и её СУБД. (СУБД - система управления базами данных)

По способу хранения информации базы данных разделяют на две большие группы: реляционные и нереляционные.


## Реляционные базы данных

Реляционную базу данных можно представить в виде **набора таблиц с информацией**, хранящихся в одном пространстве — вроде excel-файлов, которые лежат в одной папке.


![[Pasted image 20250501215801.png]]


Каждая строка таблицы в БД — это отдельная запись о каком-то объекте. В полях записи (в ячейках) могут храниться различные характеристики этого объекта. Каждый столбец таблицы должен иметь уникальное имя.

Таблица — это набор данных. Поэтому таблицам, как правило, дают названия во множественном числе, например — «заказы» (orders), «фильмы» (movies), «авторы» (authors). Но это — не обязательное правило.


![[Pasted image 20250501215848.png]]


Столбцам таблиц в БД принято давать имена в единственном числе, предельно короткие и содержательные, точно как переменным в Python.

Элементы таблицы в реляционных базах данных принято называть так:

- **Запись (строка)** — это строка в таблице. Можно сказать «Таблица **video_products** содержит четыре строки», а можно — «четыре записи».
- **Поле (столбец, колонка)** — это столбец таблицы или ячейка одной записи. Например: «В столбце `product_type` хранится тип видеопродукта». Или так: «В поле `release_year` хранится дата выхода видеопродукта». Но можно сказать и так: «В записи о фильме „Кто подставил кролика Роджера“ в поле `release_year` хранится значение `1988`».


![[Pasted image 20250501220058.png]]


### Типы данных в таблицах

В столбце таблицы реляционной БД могут храниться **данные строго одного типа**; тип данных для столбца задаётся при создании таблицы. Например, колонка `release_year` в приведённом примере хранит данные типа «целое число», и при попытке записать в это поле значение другого типа возникнет ошибка.

Самые востребованные типы полей:

- **Целое число**, как `int` в Python.
- **Число с плавающей точкой**, как `float` в Python.
- **Строка**, как `str` в Python (обычно применяется для коротких строк: названий, заголовков).
- **Текст**, как `str` в Python, но применяется для больших строк (например, для хранения текстов статей).
- **Булев тип:** логический тип данных. `True` или `False`.
- **Дата и время**. В базах данных обычно есть несколько специализированных типов для хранения дат, времени или временных интервалов.



При изучении Django вы будете работать в основном с базой **SQLite**; это компактная и лёгкая база, но она поддерживает только пять типов данных:

- INTEGER — целое число;
- REAL — дробное число;
- TEXT — строка;
- BLOB — двоичные данные;
- NULL — специальное значение, означающее отсутствие информации.

Поэтому при работе с SQLite приходится идти на всякие хитрости:

- логические значения `True` и `False` хранятся в поле типа `INTEGER` в виде значений 0 и 1;
- при работе со временем и датой значения в базе данных сохраняют в виде строк или чисел.


### Связи между таблицами

Реляционная база данных может содержать множество таблиц с различными данными, и эти данные могут быть связаны между собой.

Вернёмся к таблице с видеопроизведениями: у каждого фильма есть режиссёр (а то и несколько), и о каждом режиссёре в БД можно хранить какую-то дополнительную информацию.


Каждый из этих режиссёров снимал какой-то фильм, упомянутый в таблице **video_products**; название произведения должно быть связано с его именем. Для этого в каждой записи таблицы **video_products** можно указать, с какой записью в таблице **directors** связана эта запись.


Для организации связей между таблицами нужно твёрдо знать, какая запись на какую ссылается. Точный «адрес» каждой записи в таблице определяется уникальным идентификатором, **первичным ключом** (англ. _primary key_, **PK**). Этот ключ хранится в одном из полей таблицы; PK должен быть уникален в пределах таблицы.


В таблице **directors** первичные ключи записей хранятся в колонке `id`.


### Налаживаем связи

В ссылающейся таблице создают специальное поле для **внешнего ключа** (англ. _foreign key,_ **FK**); при создании этого поля указывается, на какую таблицу оно ссылается. В записях в этом поле указывается, на какой PK другой таблицы ссылается это поле.

В таблице **video_products** создадим дополнительную колонку `director_id` — это будет **Foreign Key**, колонка, ссылающаяся на таблицу **directors**; в этой колонке в каждой строке укажем идентификатор того режиссёра, который снял фильм.

Заодно добавим в эту таблицу колонку `id`, в ней будут храниться первичные ключи (PK) записей этой таблицы. Пригодятся.


## Не только SQL: альтернатива реляционным базам данных

Реляционные БД требуют чёткой структуры. Однако информация, которую надо хранить в базе, может быть очень разнородной. Для работы с большими объёмами разнородной информации были придуманы другие типы баз данных**.**


Такие базы называют **NoSQL** (Not Only SQL) — это не название технологии, а просто общее имя для достаточно разнородной группы баз данных.

Существует несколько типов NoSQL баз данных, например:

- базы типа **«ключ-значение»**. Типичный представитель — _Redis._ Все данные Redis хранит в виде словарей, в которых ключи связаны со значениями. Главное преимущество таких баз — очень быстрое получение данных. Заявляется до 100 тысяч операций чтения-записи в секунду на компьютере начального уровня производительности. Обычно подобные БД используются для кэширования;
- **документоориентированные** базы. Типичный представитель — _MongoDB_. Единицей хранения в такой базе данных выступает **документ** (по формату он похож на обычный словарь), в который может быть записано всё что угодно. Документы объединяются в коллекции, а те, в свою очередь, тоже могут быть объединены в какую-то более сложную иерархическую структуру. Система управления БД позволяет быстро находить нужную информацию в разнородных документах.

