[[Фреймворк Django. Работа с проектами]]
[[Python]]
[[API]]
[[Питон Практикум]]

# Взаимодействие фронтенда и бэкенда

## Multi Page Application vs Single Page Application

Вопрос с изображениями котиков на бэкенде решён. Но тут же появился другой. Фронтендеры пишут SPA, настраивают запросы, и им нужна фиксированная версия API со статической докой.

Да, это точно. Давайте разбираться.

## MPA vs SPA

Типичный веб-сайт состоит из множества страниц. Когда пользователь переходит по ссылкам, браузер каждый раз отправляет запрос на сервер и получает в ответ новые страницы. Эти страницы могут быть отдельными HTML-файлами и лежать на сервере или динамически генерироваться под запрос. Один из примеров динамической генерации — система рендеринга в Django, когда используются заранее подготовленные шаблоны фронтенда.

Такая концепция архитектуры сайтостроения называется «многостраничное приложение» (англ. _Multi Page Application, MPA_), где каждый клик по ссылке — это отдельный запрос к серверу, в ответ на который приходит целиком новая страница или файл.

![image](https://pictures.s3.yandex.net/resources/Untitled_1661960427.png)

В начале 2010-х появилась новая концепция — «одностраничное приложение» (англ. _Single Page Application, SPA_).

SPA — это всего лишь один HTML-документ, который браузер получает после самого первого запроса к серверу. Этот документ открывается и подгружает за собой код целого приложения, которое начинает выполняться прямо в браузере. Такое приложение может работать автономно и «ходить» на сервер не за целыми страницами, а только за необходимыми данными.

Когда пользователь переходит в нужную ему часть сайта, браузер берёт уже загруженные данные и показывает их, или в фоновом режиме подгружает контент с сервера, но при этом полностью страницу не обновляет.

![image](https://pictures.s3.yandex.net/resources/Untitled_11_1661765849.png)

SPA — это не просто фронтенд; это полноценное приложение, которое работает в браузере пользователя. Оно умеет взаимодействовать с другими приложениями, например с приложениями выполняемыми на стороне сервера. Такое взаимодействие осуществляется через API.

У этого подхода есть два весомых преимущества:

1. Пользователь быстрее получает данные, ведь не нужно загружать страницу целиком после каждого действия. В интерфейс SPA подставляются только те данные, которые понадобились пользователю в данный момент.
2. Упрощается адаптация приложения под разные платформы. SPA взаимодействует с приложениями выполняемыми на стороне сервера через API, а ответы от API в формате JSON подходят и для десктопного, и для мобильного приложения, чего не скажешь об ответах в формате HTML. Для мобильных приложений этот формат не самый лучший способ обмена информацией.

## Архитектура Kittygram

Проект Kittygram теперь уже не просто бэкенд; он будет представлен в виде двух приложений: Kittygram Frontend и Kittygram Backend.

Kittygram Frontend, как было определено, будет представлять из себя SPA на `React`, которое будет выполняться в клиентских браузерах. А Kittygram Backend — это серверное приложение, тот самый API, который вы писали до сих пор.

Kittygram Frontend вам предоставят фронтендеры, а Kittygram Backend у вас уже есть. Ваша задача на ближайшие уроки — «подружить» между собой эти два приложения.

Что-то подобное вы уже делали, когда отправляли запросы к API проекта через Postman. Kittygram и Postman — это тоже два приложения, точно так же, как Kittygram Frontend и Kittygram Backend. Мостик между ними остаётся тот же — ваш API.

![](https://pictures.s3.yandex.net/resources/illustration_2_1672399217.png)

То есть все действия пользователя во фронтенд-приложении будут отслеживаться; какие-то из них будут обрабатываться непосредственно самим SPA, другие — преобразовываться в нём в соответствующие запросы к API и отправляться; ответы на них будут использоваться SPA для отображения полученной информации в браузере или иного интерактивного взаимодействия с пользователем.

Фронтенд-разработчикам нужно чётко понимать, как их SPA должно взаимодействовать с API, чтобы пользователь получал желаемый результат. Нужно знать каким запросом можно создать пользователя, как можно получить токен для него или каким запросом можно добавить нового котика, а также какие для этого нужны обязательные и необязательные поля в теле запроса.

Таким образом, чтобы наладить взаимодействие между приложениями, нужно договориться с фронтендерами о правилах взаимодействия.

Это можно сделать только если определить один источник правды. Таким источником должна стать документация.
