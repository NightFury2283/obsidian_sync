[[Питон Практикум]]
[[Фреймворк Django. Работа с проектами]]


## Форма на основе модели: класс ModelForm

Модель готова, теперь можно создать форму, данные из которой будут передаваться в объект этой модели.

Перепишем класс `BirthdayForm`: сгенерируем форму, унаследовавшись от встроенного класса **ModelForm**: он создаёт формы на основе заданной модели. Класс `ModelForm` импортируется из модуля `forms`, оттуда же, откуда и класс `Form`.

При создании формы на основе модели нужно

1. Создать класс, унаследованный от `forms.ModelForm`.
2. В подклассе `Meta` созданного класса указать модель, на основе которой должна быть построена форма.
3. Указать поля, которые должны отображаться в форме. В форме необязательно использовать все поля модели. Определить список полей можно с помощью атрибутов `fields` или `exclude`:
    
    - `fields = ('first_name', 'birthday')` — в форме будут показаны только перечисленные поля модели;
    - `exclude = ('last_name',)` — в форме будут показаны все поля модели, за исключением перечисленных;
    - если в форме нужно использовать все поля, то указывается значение `fields = '__all__'`.
    
    «Явное лучше неявного», так сказано в “The Zen of Python”.
    
    Перечень полей, отображаемых в форме, лучше указывать явным образом. В ином случае можно по недосмотру вывести в форму поля, значения которых должны устанавливаться автоматически, например внешний ключ (Foreign Key) объекта.
    
    Можно скрыть в форме и те поля, которые должны быть заполнены позже, а не сразу при создании объекта.
    

В файле _birthday/forms.py_ измените класс `BirthdayForm`:

- унаследуйте его от `forms.ModelForm`,
- удалите все существующие описания полей,
- в подклассе `Meta` укажите связанную с формой модель; укажите, что в форме должны использоваться все поля модели: `fields = '__all__'` — это наглядно продемонстрирует, к чему может привести забывчивость разработчика.

Чтобы форма работала как раньше — нужно указать, что для поля с датой рождения используется виджет с типом данных `date`.

Виджеты полей описываются в подклассе `Meta`:


View-функцию и шаблон пока что оставим без изменений.

## И что в результате?

Проект работает точно так же, как и прежде: предоставляет пользователю форму, а после отправки формы выводит на страницу приветствие и счётчик дней. Данные, отправленные через форму, не сохраняются в БД: эту операцию нужно описать во view-функции.

Однако есть и неоспоримый прогресс: теперь в проекте есть модель и связанная с ней форма; если добавить в модель новое поле — соответствующее поле будет автоматически добавлено и в форму.

Запустите проект и убедитесь, что форма выглядит и работает как раньше (за одним исключением: длина фамилии ограничена 20 символами).


