
[[Питон Практикум]]
[[Фреймворк Django. Работа с проектами]]

Конкретизируем задачу. Вот что нужно сдедать:

1. Перевести и локализовать интерфейс админки.
2. Перевести название проекта: вместо _ice_cream_ должно быть «Каталог мороженого».
3. Перевести названия моделей в админке:
    - Category — «Категории»
    - Topping — «Топпинги»
    - Wrapper — «Обёртки»
    - IceCream — «Мороженое»
4. Перевести названия столбцов таблиц.
5. Настроить отображение записей так, чтобы вместо `IceCream object (<id>)` отображалось название сорта мороженого (значение поля `title` записи).

## Локализация и перевод

В Django есть встроенная система интернационализации, она поддерживает множество языков.

Чтобы переключить интерфейс админки на другой язык, надо [найти кодовое обозначение нужного языка](http://www.i18nguy.com/unicode/language-identifiers.html) и подставить его в константу `LANGUAGE_CODE` в файле _settings.py_:

```python
# anfisa_for_friends/settings.py

# Переводим на русский!
LANGUAGE_CODE = 'ru-RU'
```


## Verbose name: переводим названия приложения и моделей

Название приложений придуманы разработчиком, и перевести эти названия должен сам разработчик: в файле интернационализации таких переводов точно нет.

Задать название приложения в том виде, как оно должно отображаться в интерфейсах Django, можно в файле _apps.py._

Добавьте в класс `IceCreamConfig` свойство `verbose_name` со значением `'Каталог мороженого'`; сохраните файл, обновите страницу админ-зоны: название раздела в админке изменится.

```python
# ice_cream/apps.py
from django.apps import AppConfig

class IceCreamConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'ice_cream'
    # Добавить строчку:
    verbose_name = 'Каталог мороженого'
```


## Переводим название модели

Управление записями БД в админке разбито на разделы в соответствии с моделями; разделы названы по названиям моделей.

Но администратор сайта, скорее всего, понятия не имеет о моделях: для него слова _Categorys_, _Ice creams_, _Topping_ и _Wrapper_ — просто заголовки на странице. И он удивится: «почему было не назвать разделы понятно?». Не проблема, поможем админу.

Название модели, которое будет отображаться в админке, нужно указать в классе `Meta` этой модели.

Понадобится добавить два свойства:

- `verbose_name` — расширенное название_,_
- `verbose_name_plural` — расширенное название во множественном числе_._

```python
# ice_cream/models.py
...

class Category(PublishedModel):
    title = models.CharField(max_length=256)
    slug = models.SlugField(max_length=64, unique=True)
    output_order = models.PositiveSmallIntegerField(default=100)

    class Meta:
        verbose_name = 'категория'
        verbose_name_plural = 'Категории'
```


## Переводим названия атрибутов моделей

Названия атрибутов моделей отображаются, например, на страницах создания или редактирования объекта в админ-зоне.


В админ-зоне заголовки полей ввода генерируются из названий атрибутов модели и выглядят они непонятно; лучше дать этим полям нормальные читаемые заголовки. В Django предусмотрена такая возможность: для каждого из атрибутов модели можно указать аргумент `verbose_name`:

```python
# ice_cream/models.py
...

class Category(PublishedModel):
    title = models.CharField(max_length=256, verbose_name='Название')
    slug = models.SlugField(max_length=64, unique=True, verbose_name='Слаг')
    output_order = models.PositiveSmallIntegerField(
        default=100,
        verbose_name='Порядок отображения'
    ) 
```


Человекочитаемое название поля можно указать первым позиционным аргументом:

```python
# ice_cream/models.py
...

class Category(PublishedModel):
    title = models.CharField('Название', max_length=256)
    slug = models.SlugField('Слаг', max_length=64, unique=True)
    output_order = models.PositiveSmallIntegerField(
        'Порядок отображения',
        default=100
    )
```


Эти варианты взаимозаменяемы, однако последний вариант не всегда применим. Например, при указании типа поля ForeignKey первым параметром указывается связанная модель.


## Выводим читаемые названия объектов

Список объектов любой из моделей выглядит в админке не очень презентабельно и совершенно непригоден для управления данными: как понять, что за сорт мороженого кроется, например, под заголовком _IceCream object (8)_?

Настроим вывод записей так, чтобы в качестве заголовка показывалось название мороженого (значение поля `title`). Те же настройки подойдут и для других моделей.

Для этого в модели нужно переопределить «магический» метод `__str__()` и указать в нём, какое поле должно возвращаться в качестве строкового представления объекта:

```python
def __str__(self):

        return self.title
```

## На заметку

- После добавления/изменения verbose_name и атрибутов класса Meta стоит создать и применить миграции. Несмотря на то, что Django создаёт в этом случае новые миграции, физически структура БД не меняется.
- В работе соблюдайте код-стайл описания моделей Django. Познакомиться с ним поближе можно [здесь](https://docs.djangoproject.com/en/dev/internals/contributing/writing-code/coding-style/#model-style).
