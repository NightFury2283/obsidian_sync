
[[Питон Практикум]]
[[Python]]
[[Фреймворк Django. Работа с проектами]]

Управлять сайтами через консоль не очень удобно. Когда проект будет готов и передан заказчику — управлять проектом будет, скорее всего, не программист, а кто-то из менеджеров. Заставлять его работать с проектом через консоль негуманно: вполне вероятно, что этот инструмент ему незнаком.


Администратору сайта лучше дать другой способ управления. Например, в Django есть встроенное приложение `django.contrib.admin`. Оно создаёт графический веб-интерфейс, который позволяет добавлять, удалять или изменять данные. Этот интерфейс называют «административная зона», «админ-зона» или просто «админка».

Разумеется, доступ к админ-зоне должен быть только у администратора сайта: нельзя пускать туда всех подряд. Для управления правами пользователя в Django есть другое стандартное приложение: `django.contrib.auth`.

Приложения `django.contrib.admin` и `django.contrib.auth` подключены по умолчанию и становятся доступны сразу после развёртывания проекта.


### Создание суперпользователя

Пользователей с правами superuser (иначе их называют «суперпользователями») можно создать через админ-зону (там есть специальный раздел для управления пользователями). Но первого суперпользователя нужно создать через консоль.

Активируйте виртуальное окружение проекта «Анфиса для друзей» и выполните команду

```bash
python manage.py createsuperuser
```


После этого система запросит имя для нового пользователя, адрес его почты и пароль:

```bash
# Придумайте логин (например, своё имя на латинице).
Username (leave blank to use 'user'):  
Email address:  # Укажите почту.
Password:  # Придумайте пароль (введённые символы отображаться не будут).
Password (again):  # Повторите пароль.
Superuser created successfully.
```


Под этой учётной записью вы сможете войти в админку и управлять проектом. Если вы забудете пароль — можно поменять его через консоль `python manage.py changepassword <user_name>`, а можно просто создать нового суперпользователя.


По умолчанию, пароль и логин проверяется такими валидаторами:

- `UserAttributeSimilarityValidator`: пароль и имя пользователя не должны быть сходными;
- `MinimumLengthValidator`: длина пароля не должна быть меньше 8 символов;
- `CommonPasswordValidator`: пароль не должен входить в список самых распространённых;
- `NumericPasswordValidator`: пароль не должен состоять только из цифр.

Админ зона Анфисы для друзей:

Имя пользователя: aleksandr
email: ничего не писал
пароль: Srt16656


## Добро пожаловать в админ-зону!

Запустите в активированном окружении сайт командой: `python manage.py runserver`


Откройте в браузере страницу авторизации — [http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/)


![[Pasted image 20250509195227.png]]


Введите имя и пароль суперпользователя — и вы попадёте в админ-зону сайта:

![[Pasted image 20250509195326.png]]


Интерфейс админки сейчас на английском, а для управления доступен только раздел AUTHENTICATION AND AUTHORIZATION — в нём собраны инструменты для управления пользователями. Чтобы в нашем проекте можно было управлять сортами мороженого, категориями и топпингами, в админ-панель нужно добавить модели.


### Добавление моделей в админ-панель

Админ-зона может отображать веб-интерфейсы для управления объектами моделей, но для этого модели должны быть подключены к админ-зоне. Разработчик вручную указывает, какие модели должны управляться через админку — ведь в проекте могут быть и служебные модели, которые не нужны в админ-зоне.

Для отображения в админке модели регистрируются в файлах _<имя_приложения>/admin.py_ Добавим модель `Category` в интерфейс админ-зоны; для этого надо зарегистрировать модель в файле _ice_cream/admin.py_.

Пока что файл _ice_cream/admin.py_ пуст.

```python
# ice_cream/admin.py
from django.contrib import admin

# Register your models here.
```

Добавьте в него такой код:

```python
# ice_cream/admin.py
from django.contrib import admin

# Из модуля models импортируем модель Category...
from .models import Category

# ...и регистрируем её в админке:
admin.site.register(Category)
```


Сохраните файл, обновите страницу админки — и в ней появится новый раздел:

![[Pasted image 20250509195635.png]]


Перейдите в раздел **Categorys** админ-зоны: там отображаются созданные в проекте категории; для создания новых категорий есть кнопки **ADD CATEGORY** и **Add**.

![[Pasted image 20250509202449.png]]


Нажмите на кнопку **Add** и создайте новую категорию: заполните поля Title и Slug (содержимое для полей придумайте самостоятельно; из содержимого поля Slug в дальнейшем будет генерироваться URL веб-страницы, где будет отображён список сортов мороженого этой категории). В поле Output order можно оставить значение по умолчанию.

В интерфейсе админки названия полей Title, Slug и Output order написаны жирным шрифтом. Это подсказка для администратора: «поля обязательны для заполнения». Если не заполнить эти поля, то при сохранении данных система выдаст сообщение об ошибке.

После заполнения всех полей нажмите кнопку **Save**.


Проведите эксперимент: запомните id созданной только что записи и удалите её (кликните по её названию; на открывшейся странице будет кнопка для удаления. А можно поставить галочку возле названия и в поле Action выбрать нужное действие). После этого создайте новую запись.

Несмотря на то, что id удалённой записи «свободен» (записи-то нет), новой записи будет присвоен следующий по порядку id.