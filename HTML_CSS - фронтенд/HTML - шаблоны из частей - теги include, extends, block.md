
[[HTML_CSS - фронтенд]]
[[Фреймворк Django. Работа с проектами]]
[[Питон Практикум]]



Помимо стандартных HTML-тегов, шаблонизатор Django поддерживает [несколько десятков собственных тегов](https://docs.djangoproject.com/en/3.2/ref/templates/builtins/#ref-templates-builtins-tags).

С помощью тегов шаблонизатора можно собирать шаблоны из отдельных фрагментов, выполнять логические операции с переменными и делать множество других полезных вещей.

Теги шаблонизатора обозначаются так: `{% tag %}`. Для удобства восприятия удобно ставить пробел между именем тега и символами `%`.

> Теги бывают одиночные и парные. У парных есть начальные и конечные теги: `{% tag %}` ... `{% endtag %}`.


### Избавляемся от дублирования кода: теги {% **extends %} и {%** block %}

> Практически на любом сайте есть повторяющиеся фрагменты. Например, содержимое на всех страницах разное, а шапка и подвал остаются неизменными.


![[Pasted image 20250428134552.png]]



В HTML-коде страницы комментариями отмечены фрагменты, которые повторяются на всех страницах, и части, которые на каждой странице содержат уникальную информацию:

```html
<!DOCTYPE html>
<html lang="ru">
  <head>
  </head>
  <body>
    <!-- header повторяется на всех страницах -->
    <header>
      <p>Шапка страницы</p>
    </header>
    <main>
      <!-- Центральная часть - разная на всех страницах -->
      <p>Уникальное содержимое веб-страницы</p>
    </main>
    <!-- footer повторяется на всех страницах -->
    <footer>
      <p>Подвал</p>
    </footer>
  </body>
</html>
```


Для убирания повторения кода, который есть почти везде в Django есть теги `{% extends %}` (англ. _extend_, «расширять») и `{% block %}` (англ. _block_, «блок»).

Вот алгоритм их использования:

1. Разработчик создаёт **базовый шаблон** (обычно его называют _base.html_), он содержит тот HTML-код, который повторяется на всех страницах сайта. Это своего рода «рамка», обрамление страницы.
2. В базовом шаблоне размечаются области, куда можно вставить уникальное для каждой страницы содержимое. Для разметки таких «посадочных мест» применяют парный тег `{% block имя_блока %}` — `{% endblock %}`.
    
    На одной странице может быть несколько разных блоков, имя каждого блока должно быть уникальным в пределах шаблона.
    
    Напишем базовый шаблон:


```html
 <!-- base.html -->
 <!DOCTYPE html>
 <html lang="ru">
   <head>
   </head>
   <body>
     <header>
       <p>Шапка страницы</p>
     </header>
     <main>
       <!-- Изменяемая часть: разная на всех страницах -->
       {% block content %}Контента пока нет :({% endblock %}
     </main>
     <footer>
       <p>Подвал</p>
     </footer>
   </body>
 </html>
 
```




3. Разработчик создаёт **дочерние шаблоны**, в которых хранится лишь фрагмент HTML-кода — то самое уникальное содержимое страницы. Это содержимое тоже обрамлено тегами `{% block имя_блока %}` — `{% endblock %}`. Имена блоков должны совпадать с именами в _base.html_.

Именно дочерний шаблон нужно вызывать из view-функции. При рендеринге страницы содержимое блоков дочернего шаблона будет вставлено в одноимённые блоки базового.

Чтобы Django мог определить, какой шаблон служит базовым, в начало кода дочерних шаблонов вставляют тег `{% extends "адрес_базового_шаблона" %}`.

Напишем дочерний шаблон, в нём будет содержимое главной страницы:


```html
 <!-- index.html --> 
 {% extends "base.html" %}
 <!-- Имя блока — content, такое же, как в базовом шаблоне --> 
 {% block content %}
   <h1>Это главная страница проекта "ACME"!</h1>
 {% endblock %}
```


Точно так же создаём второй дочерний шаблон, для страницы со списком товаров в каталоге:

```html
 <!-- product_list.html --> 
 {% extends "base.html" %}
 {% block content %}
   <h1>Это страница "ACME" со списком товаров!</h1>
 {% endblock %}
```


Теперь:

1. View-функция вызовет шаблон _product_list.html_.
2. Шаблонизатор увидит в коде файла _product_list.html_ тег `{% extends "base.html" %}`.
3. Шаблонизатор вызовет файл _base.html_ и вставит содержимое блоков дочернего файла в одноимённые блоки базового файла.

Готово, страница собрана!


Если в дочернем шаблоне нет тега `{% block content %}`, тогда на веб-страницу будет выведено значение, которое предустановлено в базовом шаблоне. В приведённом примере будет показан текст `Контента пока нет :`


Поскольку базовый шаблон относится ко всем шаблонам проекта, его принято размещать прямо в корне папки _templates/_.


![[Pasted image 20250428135330.png]]


### Повторное использование HTML-кода. Тег {% include %}

HTML-документ — это, как правило, сотни строк кода. Чтобы упростить работу, шаблоны разделяют на части. Это позволит редактировать каждую часть отдельно, работая с небольшими фрагментами кода.

Хорошим решением будет отделить от базового шаблона код шапки сайта и код нижней части страницы (подвала) — и вынести эти фрагменты в отдельные файлы.

Отделённые фрагменты включаются в основной файл с помощью тега `{% include "адрес_подключаемого_файла" %}`.


![[Pasted image 20250428135701.png]]


Аргументом тега должен быть адрес шаблона, код которого надо включить в файл, — `{% include "адрес_файла" %}`:

_base.html_

```html
<!DOCTYPE html>
<html lang="ru">
  <head>
  </head>
  <body>
    {% include "includes/header.html" %}
    <main>
      {% block content %}Контента пока нет :({% endblock %}
    </main>
    {% include "includes/footer.html" %}
  </body>
</html>
```


Шаблоны, встраиваемые через тег `{% include %}`, обычно хранят в директории _includes/_, вложенную в папку _templates/_.

Скопировать код

![[Pasted image 20250428135800.png]]




## Пример работы:


> В папке _templates/_ хранятся HTML-шаблоны для всех приложений:
> 
> - _templates/about/description.html_
> - _templates/homepage/index.html_
> - _templates/ice_cream/detail.html_
> - _templates/ice_cream/list.html_
> 
> В перечисленных шаблонах есть повторяющиеся фрагменты кода. Это непрактично, нарушает принцип DRY и усложняет работу с проектом.
> 
> Сделайте проект лучше: создайте базовый шаблон и шаблоны для шапки и подвала; подключите шапку и подвал к базовому шаблону; вынесите в эти шаблоны повторяющийся код.
> 
> Создайте шаблоны
> 
> - _templates/includes/header.html,_
> - _templates/includes/footer.html_
> - _templates/base.html_,
> 
> Содержимое тега `<header>` перенесите в файл _header.html_, содержимое тега `<footer>` — в файл _footer.html_.
> 
> Подключите файлы _header.html_ и _footer.html_ к шаблону _base.html_.
> 
> В файл _base.html_ вставьте два тега `{% block %}`:
> 
> - тег `{% block %}` с именем `title` — для содержимого HTML-тега `<title>`,
> - тег `{% block %}` с именем `content` — для основного содержимого страницы.
> 
> Шаблоны _description.html, index.html, detail.html_ и _list.html_ должны **расширять** шаблон _base.html_; в этих же шаблонах должно храниться содержимое для блоков `title` и
>  `content`



```html
{% extends "base.html" %}

<!-- description (about)-->

{% block title %}Анфиса для друзей. Описание проекта{% endblock %}

  

{% block content %}

  <h1>Описание проекта</h1>

{% endblock %}
```


```html
  

{% extends "base.html" %}

<!-- detail (ice_cream) -->

  

{% block title %}Анфиса для друзей. Подробное описание мороженого{% endblock %}

  

{% block content %}

  <h1>Подробное описание мороженого</h1>

{% endblock %}
```


```html
{% extends "base.html" %}

<!-- list (ice_cream) -->

{% block title %}Анфиса для друзей. Список мороженого{% endblock %}

{% block content %}

  <h1>Каталог мороженого</h1>

{% endblock %}
```


```html
{% extends "base.html" %}

<!-- index (homepage) -->

{% block title %}Анфиса для друзей. Главная{% endblock %}

  

{% block content %}

  <h1>Главная страница</h1>

{% endblock %}
```


```
<!DOCTYPE html>

<!-- base -->

<html lang="ru">

<head>

    <title>{% block title %}Анфиса для друзей{% endblock %}</title>

</head>

<body>

    <header>

        {% include "includes/header.html" %}

    </header>

    <main>

        {% block content %}{% endblock %}

    </main>

    <footer>

        {% include "includes/footer.html" %}

    </footer>

</body>

</html>
```


```html
<footer>

    <p>Копирайт, год создания</p>

</footer>
```


```html
<header>

    <p>Место для логотипа</p>

    <nav>Навигация</nav>

</header>
```